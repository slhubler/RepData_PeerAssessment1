<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Reproducible Research: Peer Assessment 1</title>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}

pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Reproducible Research: Peer Assessment 1</h1>

<h2>Tools</h2>

<p>Here I include constants and routines that are used in the rest of the document.</p>

<h4>Constants</h4>

<pre><code class="r">DATA_FILE = &quot;..\\..\\Data\\activity.csv&quot;
LIST_OF_WEEKDAYS = c(&quot;Monday&quot;,&quot;Tuesday&quot;,&quot;Wednesday&quot;,&quot;Thursday&quot;,&quot;Friday&quot;)
</code></pre>

<h4>Support functions</h4>

<pre><code class="r"># Converts a date (in text) and time of numeric format to POSIXct format
#   Input: dt_text is the date (text format, yyyy-mm-dd)
#   Input: tm_number is the time (integer of form hM, e.g. 105 is 1:05)
#   Output: Time/Date stamp, combining the two pieces of information
convert_date_time = function(dt_text,tm_number) {
    tm_text = sprintf(&quot;%04d&quot;,tm_number)
    date_time_text = paste(dt_text, tm_text)
    result = as.POSIXct(date_time_text,format = &quot;%Y-%m-%d %H%M&quot;, tz=&quot;GMT&quot;)
    return(result) #I prefer explicit, simple returns - not efficient but...
}

# Specialized plot to compare weekends and weekdays
plot_steps_vs_time = function(dta,day_type,max_steps){
    m = dta[dta$weekday_factor == day_type,]
    with(m, plot(time,
                 steps,
                 type=&quot;l&quot;,
                 xlab = &quot;interval&quot;,
                 ylim=c(0,max_steps),
                 main=day_type
                 )
         )
}

#Test; should return 2012-12-14 01:20:00 GMT
convert_date_time(&quot;2012-12-14&quot;,120)
</code></pre>

<pre><code>## [1] &quot;2012-12-14 01:20:00 GMT&quot;
</code></pre>

<h2>Loading and preprocessing the data</h2>

<h4>Load</h4>

<pre><code class="r">dta = read.csv(DATA_FILE)
</code></pre>

<h4>Process (Add <em>date_time</em> and <em>time</em> columns to <em>dta</em>)</h4>

<pre><code class="r">dta$date_time = mapply(convert_date_time,
                       dta$date,
                       dta$interval,
                       SIMPLIFY=FALSE
                       )
dta$time = unlist(mapply(function(a){unlist(format(a,&quot;%H:%M&quot;))}, 
                         dta$date_time, 
                         SIMPLIFY=FALSE
                         )
                  )
dta$time = as.POSIXct(dta$time, format=&quot;%H:%M&quot;)
</code></pre>

<h2>What is mean total number of steps taken per day?</h2>

<pre><code class="r">total_steps = aggregate(steps ~ date, dta, sum)
with(total_steps,hist(steps, breaks=10))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAdVBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZo8AZrU5AAA5ADk5AGU5OY85ZrU5j9plAABlADllAGVlZjlltf2POQCPOTmPOWWPjzmPtY+P29qP2/21ZgC1tWW1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v1b5Fs1AAAAJ3RSTlP//////////////////////////////////////////////////wCDVpfZAAAACXBIWXMAAAsSAAALEgHS3X78AAAN9UlEQVR4nO2d60LbSBJGR7BZ2MngZMxkd/AuzOCL3v8RVy1Ljgw2kkvdVJXrnB8xsT433XXcuhhJ/qWGkPyi3QHQAfFBQXxQEB8UxAcF8UFBfFAQHxTEBwXxQUF8UBAfFMQHBfFBQXxQEB8UxAcF8UFBfFAQHxTEBwXxQUF8UBAfFMQH5WrEbxe3z3W9e7x93v/Us1rOaHRzX908HT0zqzlLXKH4o6dX1RxT7149rzlLXKH49qdmrla3z7vHqqru6vqleXio0+Lq9n+LL6+7x5vfm7m8bp5uZvS6+mfz/HMT6q3u8+2rv7ymJ943t2x/2X/T0/1ivcELuFLx20WVpP29N7VK/2keW3H/uE/i09K/9qHXddXTyevyP8Wfaq57Y6REt/hVtwKXcUXie3dJ/Oa+05DWzZv7ZlpvFzdPm/vG7EvVir/rX3b7vK7SC6pliqTnDvnDmv1Nc81/0jusaeUh/d7lYbEjrlR8+780f5OpdWv5pVq2P2z3q/qn/kVJ/F37BuifPeQP4t8013LztN+heKkeDosdcUXi323jq27OnhPfZg7if74d3ot/09xb8YfFjrhW8YlVp+7Uqj5Z2it7L/79qv5Nc92K/bCqPyx2xJWK7ydz2hE7uXOXFK+r0zP+kB9s49831+0iph8Oix1xpeJbVd3qvJmf/eFcMz37w7mkuDH40G0BjsQf8ker+p/Nrfb78PvDuTT9+8WOuBrxk1lnO+5692mRJ0KJ7/b8HzI1h3g3rLttdx4QD/5AfFAQHxTEBwXxQUF8UBAfFMQHBfFBQXxQEB8UxAcF8UFBfFAQHxTEBwXxQUF8UBAfFMQHBfFBQXxQEB8UxAcF8UFBfFAQHxTEBwXxQUF8UBAfFMQHBfFBCSu+moB2H0sSV3yWiF8QPyviF8TPivgF8bMifkH8rIhfED8r4hfEz4r4BfGzIn5B/KyIXxA/K+IXxM+K+AXxsyJ+QfysiF8QPyviF8TPivhlVPz2+3P7lR7+vkvxYxA/QiM+ua83v31Gdz4PxI/QWN98fd3P/GsC8SNsFzd//kgz/ut1resRP0r71ctrx1+4dBLEBwXxl3MVZ6EiXo7rwiBejuvCIH6E7vtYT31LtuvCIH6M3eO5L+F1XRjEj7L9duab0V0XBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxclwXBvFyXBcG8XJcFwbxY2zuq8Tt87slrguD+BF2j8v2cf3l9e0i14VB/Ajb789HjwNcFwbxIzDjr5Pxbfx2wTb+CmGvflbELxLxVU/23nwiU8RPoHxHC8GMLx0xCuJLR4wyfji36FZq7/fu/I66Rvz4jN89PpxZ4nfUNeInrOq3355OL/A76hrxbONLR4yC+NIRoyC+dMQoiC8dMQriS0eMgvjSEaMgvnTEKIgvHTEK4ktHjLIXv13cCV7rd9Q14vsZv66qmzOfzJ7F76hrxA9W9bvHqlpe8lq/o64R34vf3KcZf+JU2g/wO+oa8f02/v05tOP4HXWNePbqS0eM0olfN1v3l0v37vyOukZ8t6pvz7XY/HrJFt7zqGvE78XvL5c5cbHMh/gddY34blXfnlJ54mKZD/E76hrx7NyVjhgF8aUjRjns1Z+5MPIj/I66Rnz/Ac5Fn9V2+B11jfhO/EUf1fb4HXWN+G5Vvzp3tcxH+B11jfh+Vc82vlTEKOzVl44YBfGlI0bpxO8eqy9/nbs48hx+R10jvv+s/mHz9ZXP6ktEjHI4nGvEX3pQ53fUNeKHM/6FGV8gYpSf2/iquvT0K7+jrhHPXn3piFEQXzpiFD65Kx0xynDGv1z4gb3fUdeIH4rncK5ExChD8WtW9QUiRjnaxl94NobfUdeIZ6++dMQoiC8dMcrRqv7CAzq/o64R3834l7v+nwvwO+oa8cOTLTmcKxExyuGvczUzvkzEKMO/zl16AyS/o64Rz1596YhREF86YhROtiwdMQonW5aOGIWTLUtHjMLJlqUjRuFky9IRo7BXXzpiFK6PLx0xSreN/+PSO1cn/I66Rjxn2ZaOGIVtfOmIUa5UfDXOhEay/B6jVUriZbt2tsVnSFz3SqEXv/l64UF8bXZICcSPgXgDEQ0QbyCiQStedI6t2SElED/Gte7VZ0gg/hxGh5RA/BiINxDRAPEGIhog3kBEA8QbiGiAeAMRDRBvIKIB4g1ENEC8gYgGiDcQ0QDxBiIaIN5ARAPEG4hogHgDEQ0QbyCiAeINRDRAvIGIBog3ENEA8QYiGiDeQEQDxBuIaIB4AxENEG8gogHiDUQ0QLyBiAaINxDRAPEGIhog3kBEA8QbiGiAeAMRDRBvIKIB4g1ENEC8gYgGiDcQ0WBUfLozUrpJzol7mhsdUgLxY0wR394AcfPbu0VGh5RA/BhTxLe3Qhvc/tL4zToTiB9jXPzi5s8faca/vxGe0SElED/GhJ273WN1V69P3APP6JASiB+DvXoDEQ0QbyCiAeINRDRAvIGIBog3ENEA8QYiGiDeQEQDxBuIaIB4AxENEG8gogHiDUQ0QLyBiAaINxDRAPEGIhog3kBEA8QbiGiAeAMRDRBvIKIB4g1ENEC8gYgGiDcQ0QDxBiIaIN5ARAPEG4hogHgDEQ0QbyCiAeINRDRAvIGIBog3ENEA8QYiGiDeQEQDxBuIaIB4AxENEG8gogHiDUQ0QLyBiAaINxDRAPEGIhog3kBEA8QbiGhgTnyVhxydR/wZyoj/pAji5SAe8flA/OeAeAMRDRBvIKIB4g1ENEC8gYgGiDcQ0QDxBiIaIN5ARAPEG4hogHgDEQ0QbyCiAeINRDRAvIGIBog3ENEA8QYiGiDeQEQDxBuIaIB4AxENMor/rNMkQ4rPU7kBOcVf/ArNiKGuTCH7L0K8gcgEEJ8rYqgrU0B8roihrkwB8bkihroyBcTnihjqyhQQnytiqCtTQHyuiKGuTAHxuSKGujIFxOeKGOrKFBCfK2KoK1NAfK6Ioa5MAfG5Ioa6MgXE54oY6soUEJ8rYqgrU0B8roihrkwB8bkihroyBcTnihjqyhQQnytiqCtTQHyuiKGuTAHxuSKGujIFxOeKfF5X7JxZPATxkSIDEB8pMgDxkSIDEB8pMgDxkSIDEB8pMgDxkSIDEB8pMgDxkSIDEB8pMgDxkSIDEB8pMgDxkSIDEB8pMgDxkSIDEB8pMgDxkSIDEB8pMmBc/Oa+PTvo9nnsN1kaIeLHGBW/e1y2j+svryO/ydIIET/GqPjt9+ejx/QbTp8jKLl/KWQkr/gPZjw4Znwbv120b6cT23hwzJy9enAM4oOC+KAgPiiIDwrig4L4oCA+KIgPCuKDgvigZBSv/LepKyefpz05xedrym+zbrqLeB/tIt54s266i3gf7SLeeLNuuot4H+0i3nizbrrLBzhBQXxQEB8UxAcF8UFBfFAQHxTEBwXxQUF8UHKJ3y6qfNdRv1Tt1bldm8cPYja/Pr9tK0vLbbu5e5xuQ7Is0t2eTOLTVfQvd3naquvVctDm8YOYdRJzssl5Lbft5u7x9ttTvfnXU4HuHsgkPt0vo33r52D3x9OgzeMHaZurm/80Lz7Z5KyW9+3m7vE6iV0t83f3J5nEb76+tm/TLLS3Ylj2bR4/zOhiU6yTTc5sObVbosfn+pmp1JnEpxulZBPfrOTSHOraPH6Y0Woj6GSTM1tu31D5e7x7fCjS3R6LM75ltXQ04/P3eLt4qIt0t8fiNr7lzBZO3uCmyDb+SHy+djf3aW/RwTY+rZiy7dWnldnux3PX5vGDnFSsk03ObLnfhOTs8d57ke72WD2Ov3nKffha+jg+Z49f2otnlg6O48EbiA8K4oOC+KAgPiiIDwrig4L4oCA+KIgPCuKDgvigID4oiA8K4oOC+KAgPiiIDwrig4L4oCA+71nhbkA84sOxTpc2bxf9P/X2+7/bk6TXEb5CObD4dEnKy10741ftNQrbxZfX9e1z9/yVE1n8/gK0dFVS81Oje7tYpksf814DaJXA4tNtJ5o1exKfrnK+2RtfLbvnr5zI4uv2Mr3uOsR6vwrobnGwznc9mFECi09y9+LTNr75abu4Sw/d89rdK0xg8fWq2t8Xp92rb1bu22+/t+v4FXv1sYixV9eB+J8gHq4fxAcF8UFBfFAQHxTEBwXxQUF8UBAfFMQHBfFBQXxQEB8UxAcF8UFBfFD+DwNF7CxWn4CqAAAAAElFTkSuQmCC" alt="plot of chunk total steps per day"/> </p>

<pre><code class="r">median_steps = median(total_steps$steps,na.rm = TRUE) #Variable used below
mean_steps = mean(total_steps$steps, na.rm = TRUE)    #Variable used below
</code></pre>

<p>The total number of steps per day has a <strong>median of 10765</strong> and <strong>mean of 1.0766 &times; 10<sup>4</sup></strong></p>

<h2>What is the average daily activity pattern?</h2>

<pre><code class="r">means_per_interval = aggregate(steps ~ time, dta, mean)
with(means_per_interval, 
     plot(x = time,
          y = steps,
          type = &quot;l&quot;,
          ylab = &quot;Mean steps&quot;,
          main = &quot;Daily patterns of activity&quot;
          )
     )
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAflBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZo8AZrU5AAA5AGU5OWU5OY85ZrU5j7U5j9plAABlADllAGVlOQBlZjlltf2POQCPOTmPOWWPj2WPtY+P29qP2/21ZgC1tWW124+1/tq1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v1QitrRAAAAKnRSTlP//////////////////////////////////////////////////////wAyqPBcAAAACXBIWXMAAAsSAAALEgHS3X78AAASTUlEQVR4nO2dDXvbqhmGD+k6p+tZ0m5xz0eyLe6JP/T//+CEvpFARoAQ6Hnuq41tWby85rYQyLL8S0Eg+WXrBMg2UDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgZCr++iwkL8Mln97l//lyby/tnyVcHsXDqymeUmn9YHEFG5C3ePE0WnpH/Jt8q7yJpV6MJfRPLK9gA7IVLxWfRfn3XPovt8dmi//fsVpUvSFux0//EaJeUa5zO5Y3f5d/DkVxqjuM2/Hh3+Lhz27NcuMW3bvnVL21qmKfP+SCpq5q0af36omDrPhNRiyFH6oMqlr6NNIka/Fy26q3/c8fbVd/KnW+1R1zJaZ+rrr9ayD+rekwaqt/1WseijZaVUm9zqEX3z5bB64VV+LP8vnr88NrK/4wSCNN8hZ/qjvVVrr8f3ksTdXbbOnnScrq1um7+stjaUquV65zaNaU9qrlDZfHqiMp/wz77rqOJpb8LxeU/cZrVb6rZZBGmuxAvNwOe/G34+efz4dqpbrlT7LDrdfpxZ/rIYLs/uuuu3Lc9A2Nr3PVf58av2298umuD2/FV5V0D+SdQRppkrf4sonlTnkovjg9/PFYe+nEt+vMiC+flOKrfXwzhJ+Kb+PUzxQD8WXZn/VtW0ufRppkLV4O7uS2JrveTnw/9+q6+nadUVdfr6OKlzSep119G6eKpWzk5f7897pnaWsxTwHTIFvx7XSu3nYH4kvdndRmcNeuI4drh+5PM05TxHd9g6QZ3PXzszZOM7ir49XiG8+N+LJQn0aa5C2+OhxT6j/J0X17AOet7Yjr6Zxs/mYdqaeSWy57q4fquq6+21JPzZGCbh/fxpF35Foy1M92r3MoGvFtBSnv4nMVP8ep1bTtsPokkj6Msz/xve5Nxac9mduh+FN/BH/Ltj+JtDf4/YkndlA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYPiI16QlFlRvEdZsjYUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aAgik82sZhQPCje4utLvwnN5WSSbd9kE4uJr/jbsbm43/Ryfcm2b7KJxcRX/PX7u3JrH3o7kk0sJtziQfHexzdXD+U+PjM4qgeF4kGBnM4lm1lEIAd3yWYWkRWmc5Znbm9HuplFBHCLF8lmFhPA6RzFSwBH9RQvoXhQQkznqt9XyudYPcVLQgzubscnis+NMNO5twPFZ0ag6dzpb18oPisCTOeqn0g9TedzqTYvxUs4qgeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQIMUnm1pEKB4UigeF4kHBEy+KZFOLCcWDgio+0eTiQfGggIrn9yYpHhSKB4XiQQEVn2py8aB4UDDFJ5tcPCgeFIoHheJBoXhQKB4UigcFVXyq2UWD4kGheFAoHhSKB4XiQUETLyi+huJBoXhQKB4UigeF4kEBEy8ovoHiQYET32aVYnYxoXhQKB4UigeF4kGheFDQxBcUX0PxoFA8KFjiRUHxDRQPCsWDQvGgUDwoFA8KxYNC8aBQPCje4i+PQvLpfWnoLaD4Dl/xt+NLdXv+/LEw9BYIw31AfMVfv78rt/aht4DiO7jFg+K9j78+57WP194HBG5Ur70PCMWDEmJwJ3v76S4+xZal+I4A4qsB/eXXpaG3gOI7Aoi/fP1QpnOixT+70FB8h7f454c/f5Nb/FdO57LCf3B3O4pDceZ0LjM4qgeF4kGheFAoHhT/UX0zd5uO7hJsWYrv8N7ib8cnt9BbQPEd/l399durU+gtoPgO7uNBgRIvjA/woHhQKB4UigeF4kGheFAoHhSKB4XiQcEVn2B+MaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHBVh8gglGhOJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFDvxp88fJyFegobeAIrvsRJ//fZa/rt8mV6a3CP0BlB8j5347+/lNk/xe8KyqxcPr2d29XuCgztQKB4UO/G3oxDiEDb0BlB8j5X4+tLkp4Xm02tXiu+xHdUX2l8K9wm9AeOM0sswHpaj+kOxwy0+wQzjYbfFm39/xD30BlB8D/KoPsEM40HxoFhP5z7/NP32jGPoDaD4Htvp3OXrx1nzG/EeoTeA4ntsp3OleE7n9sSCLf7ELX5HLDhku9B7gs1K8T0c1YPCQ7agWIjvjttxH78jFmzxgUNvAMX3QO/jE0wxGsinV6eYYjSQT6/WLkEB+fRq7RIUvE+vvjyaPqlPr1Epvsd3cHc71m8HzSc46TUqxff4im9nepoZX3qNqskovSQjAb7FJ5hkJLzn8c1xvUz38QkmGQnsAzgpJhkJO/Hn5efYptimG4pPrjEsT682H7TLezpH8QbufkjDwZ1z1dti19W/PZlW0EznREuA9MKynfj0GmPJN2l0+/jct/hIWS4Vv35WSNM5bUIUr2VX0zmKt6+h+5BmD9M5irevofs8/nzI/2vSFG9fQzedq/+FDB0firevofkmzY/X8p/2RIyZr85T/KCWPMUXpfOzENrJfH19HIfQ8aF4+xosRvVX09en9yfe/RXtUbxr6PhsJ14sLZqK+H1cGMFfvOtLylX8Ti6MQPH2NezqwggBunrH1yQWtoZzRUuqmGVXF0ageKWKWXZ1YQRf8Uv1uZdMRvwaoeND8UoVs1C8uirF+4eOD8UrVcwixVc7eH4siydefhpvPOfOPXR8KF6pYpa2q5dnYiyVT/HOJdMRL3ljV48n/k0svhIKxSt15Ch++eVvbELHJyfxq5+Jz1H9ovJrixdLCzjDefyi8hHFr9x+FL+oPMX7h44PxU9rMkHx6qoU7x86PtmIH/5dC4pfVJ7i/UPHJzPx6zYgvPgFaVJ8kNDxSV+8oPg1oPhhVfNPU7y65grih09Q/CpsKt5YlOJXJ4B4txe1TLyg+MAkKV5MxbdLKD4QFD/OyQzFj1akeO/Q8UlXvFAeUHxgNhevK0zx67OV+G6Opiksiqn4xZm5gCPedObq1uKHT1D8CuQiXowLrgPFJyVezZLiQ2C6gH5M8dPSFL86CYsXFL8iGYgXBcWHpZ4eU/wkKSN7Er/54E6XAcWvCsUbkjKyK/Hm56yDULx/6JisIH7Bq2u1Unx0khXf7IMofiVGh0LV56yDKGtTvGvomKQiflKqHXXqZ3wU7wvFm5IysR/xxmwoXkdm4o1bdcri++woPnSVaYjXlGpj6sWv2YQUb5umGPxdUKyg+AjkLb5ageJDVpmEeF2pqXin3ByAEK8/TH6nkH61XrzQPX2vAopfB/NH7jNXCLXLUyg3FO8eeg2SFz8uRvFh2FK8XQU68cVAvEtqTuxK/My5FhS/LDTFj9aieO/QK0Dx9qCI957OmcT36kxxjOM1QfGB0Da+CCq+fwOEEC+UpRTvXqNZ/Fwpu9jKrbP4wcP74ldsw32Lbzb1sOKFUpWPeEHxYdhQ/EwtOxV/eTT9UFEa4ufOuupWsord3AqdePWKBrPxdyL+dqx/mew8/XX5LcSPR1L1xzPW4mdWNIoX3V8o8dfv78qtfegVEKONXhTBxA+mcRQvSW+Lz0h81qP663My+/i68dcWrw7u2ocO4kWRtXjn0OHRiJ90AoZiSoHZlSjeHLLFKSEPHMUrna+p9efFq1erM4ZXH4rxwqzEy0Gd7O2nu/iNtvjhMXRlo5wv19wzHfub7A9WEK8rnrT4akB/+XVp6PDU4jsjW4i3kLcf8ZevH2lM50ZGOvH3EnETP6xuTrzxHK3MxT8//Pmb3OK/bj+dG4tvO31r8YYZgJd485K8xVc/L38ozqlM5zTi7yaiitebuie+fsZQWL8kd/GuocMjhjeDXntL8YYOZNw7ULwPq4kXc+KVnYqt+PFHR3fFB29MircSP5bkKV5MRh76gSHF29Smeh4cQVoiXntlKmvx08Ja8e02r66nTdP2NSxml+LFdIuaLzosqRMvJqvfFa90P7pMKT4MI/FLKl8ovt0ht5M/rfjxSbjaTNWYFO9Y24rip+sr4ifbOcVHQ6hb26JPiIYjKJ0As3ihEy8GZfQDNhfxoVtzl+IXttMd8boBWzM8m4jv9/0z4g3Dd4p3qmwT8ZOuvmg7mxnxhm6A4t0q8xYvlorXDOkG4pVV7gQsKN69sh2Lb7uXoFC8u/juYRDx+owp/l5lo5ZbJr5p3m4THj09WX9GvHpqFsWvTZri7bOgeOfK3C8NKNoBOsV3ZCt+edm+z9hEvGHVVjrFGytLRHzRi1+S0V3xoZtzR+K9yiqH6cXo6cn6K4ifWV5nRvGGymKKFzMPB+IX5WBeTvGzdXlUV3+bevTd1UL/qLgrvmhHiiEagOLv1rWZeN2ndxQfiQTFh3n9ottrCG0uPoHnoHgb8fpkVhXvHZziC734Ptym4hvpFG+uy0d8oYqv21p09yerU7xH6KD41VU37Uh8QfHrhA5KCPHFSHzzmOIDhw5KiuLDMBIvusXecWeheF1oMfswjnjfGii+0Ipv+2rTudBzlVN8PLzFFybxusgU7xM6KIHFtyfMpyK+GIpX3wHucWeBEj9c0rV2muL9Pwig+EI7+Zp2AvaVryO+ex9SfLC6KH4CrPhmuVPcFcT3YQXFh61LK94tbFDxyjGbaoBP8UGrCio+5EsXgzv1zK4fdHrUQ/EzIVIWb9w/LQ2rh+KdQq0ovqD4sFVZzNftY0US71MPxc+ESF68xwun+BVYVXwxdE/xSRH8i2511F788HiOe7Q5KN6FtcQrp2FQfNyqbFgpHTF+RPEY4seVeB0hpPgViJOOoPjEvFN8LFITH4fu0J3Ty6f4bKF4UPEVzgduKT5vKB4U59k8xecNxYNC8aBQPCjQ4oG9ux+/o/jM6b7lt7Tc/NMUnzpT8XbNQfGZMxFveTyH4nNHEW9/II/ic6f+nGZwGibFIzE4DZPikRD9X4qHQqh/7NY3Q/G5MHBu1R47EE/vkjnxuhbKT7zVy8JjMKsb67e5cteYNMWL8QIy/KxmIl7XRLmKb3u28S9M4jIRP3iYu/jGdneJ8aW/8bVrRj+w0R/D21q80C5d8v5oL/sjuuuBOH4ytUum4kd3RqvPR7sv/vIoJJ/e74UedkCDp4ZbrNDcG3Rg/fWehOl9jIzaeop4TVP5ir8dX6rb8+ePe6GnHXWh+hu+Z7uDz+1vhigXA+g2d6Kja1QhjN29r/jr93fltqlNCDHZ+XbLapmiTWuw/rDoMEZf0vRTUWTI9Pd0pjbmI4Tc4klKeO/jr8+W+3iSFFlN50g4KB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHZU3xJGXWEx+Y0B1I8A4p9QQXxaP47QJSfE3q7Zp8ghS/TrzkE6T4deIlnyDFrxMv+QQpfp14ySeYq3gSE4oHheJBoXhQKB4UigeF4kGheFAoHhSKB2VL8ddnUX/3uv0qdrOgW+4W7/LYfrXXM17J5ct7wASbeMESnBRfEG9D8bI1Twd57yReBgv65U7xrs/lTfW6PeOVnBtDYRJs4gVLcFJ8SbwNxctrbNRbwD/+9SLvNQu65W7xLl8/iuu3V/94RfH28EdVLlCCTbxgCarFF8bbUHzTAMXtx591T9q2SLPcMV5f3DNeFVO2X6gEm3jBEvR6wRuKlxdXkfmdnppdaLOgXe4Yr+pJH17940kq8aESbOIFS3BSfEm87bf48uYWcouXY6d//gi4xQdLsOgHd0ESzHWLb3ZFp+ok8KdivM9yjdfe9Y4nkeWCJVh0s4QwCU6KZ7KPvx2fBqPRfkG/3Cletfc4BIgnUadz/gGrrj5UgpPiS+IlM4+v934hprVnIW8CxCsU8UECVvGCJagUXxiPR+5AoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKBwVcfP3Vo62z2AKK3zqFjcAWf30Wn/775f3243chns7VtybkIoQ3A7b4pqu/HQ/F5fFQbf9v7t++yAqKl+J/yO/svlZfufz22ny/aedQ/Ej8sxDiwe0blllB8SPxCFu7hOJV8XIff3b9pl1OgIu/HetRfS++7OsRenp08bhQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KP8HAggjMhyNF4oAAAAASUVORK5CYII=" alt="plot of chunk daily activity pattern"/> </p>

<pre><code class="r">max_mean = max(means_per_interval$steps) # Variable reported below
max_ind = which(means_per_interval$steps == max_mean)
max_interval = means_per_interval$time[max_ind]
max_interval = format(max_interval,&quot;%H:%M&quot;) # Variable reported below
</code></pre>

<p>The maximum mean number of steps found in any interval (206.1698)
is found in the interval starting at <strong>08:35</strong>.</p>

<h2>Imputing missing values</h2>

<h4>Report number of missing values</h4>

<pre><code class="r">count_of_missing_values = sum(is.na(dta$steps)) # Variable reported below
</code></pre>

<p>The total number of missing values is <strong>2304</strong>.</p>

<h4>Strategy for filling in missing values</h4>

<p>The goal for filling missing values is to minimize the effect of new values on the overall structure.  The simplest method that has some chance of doing this is one that uses the mean activity at a particular time of day to replace values that are missing at that time of day (i.e. we assume that variation caused by time of day is greater than variation driven by the date).</p>

<h4>Use strategy and create new dataset</h4>

<pre><code class="r">na_idx = is.na(dta$steps)
na_time_list = dta$time[na_idx]
matches = match(na_time_list,means_per_interval$time)
dta_imputed = dta
dta_imputed$steps[na_idx] = means_per_interval$steps[matches]
</code></pre>

<p>The new dataset, <em>dta_imputed</em>, has been created.</p>

<h4>How does imputation affect the results?</h4>

<pre><code class="r"># Count steps per day
steps_per_day     = aggregate(steps ~ date, dta,         sum)
steps_per_day_imp = aggregate(steps ~ date, dta_imputed, sum)

# Histograms
with(steps_per_day,hist(steps,breaks=20,main=&quot;Histogram of steps (original)&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk Imputation results"/> </p>

<pre><code class="r">with(steps_per_day_imp,hist(steps,breaks=20,main=&quot;Histogram of steps (imputed)&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk Imputation results"/> </p>

<pre><code class="r">#Table comparing results
means   = c(Original = mean(      steps_per_day$steps), 
            Imputed  = mean(  steps_per_day_imp$steps))
medians = c(Original = median(    steps_per_day$steps), 
            Imputed  = median(steps_per_day_imp$steps))
means = as.data.frame(means)
medians = as.data.frame(medians)
tbl = cbind(means,medians)
tbl
</code></pre>

<pre><code>##          means medians
## Original 10766   10765
## Imputed  10766   10766
</code></pre>

<p>This form of imputation has minimal effect on the &ldquo;center&rdquo; because missing values are in entire days &ndash; effectively in imputation increases the number of &ldquo;average&rdquo; days. Side effects for the choice of imputation method on the total number of steps in a day include:</p>

<ul>
<li>The mean remains unchanged.</li>
<li>Days filled with NA are replaced with &ldquo;average&rdquo; days (increasing the number of such days)</li>
<li>The median is driven closer to the mean.</li>
<li>The variance (not displayed) is reduced.</li>
<li>The shape of the histogram is changed except for the rectangle containing the mean, which increases in size.</li>
</ul>

<p>The size of these effects are dependent on the number of missing values. This analysis also assumes that entire days are missing, not partial days.</p>

<h2>Are there differences in activity patterns between weekdays and weekends?</h2>

<h4>Create new factor (<em>weekday_or_end</em>)</h4>

<pre><code class="r"># I&#39;m annoyed with the [[1]] hack but I haven&#39;t found a way around it yet.
# It has to do with the use of mapply above.
weekday_list = unlist(lapply(X = dta_imputed$date_time,
                             FUN = function(a){weekdays(a[[1]])}
                             )
                      )
weekday_label = unlist(lapply(X = weekday_list,
                             FUN = function(a)
                                 {
                                 if(a %in% LIST_OF_WEEKDAYS){&quot;weekday&quot;}
                                 else {&quot;weekend&quot;}
                                 }
                             )
                      )
weekday_factor = as.factor(weekday_label)

# I decided on new variables to simplify testing
dta_w_weekday         = cbind(dta,        weekday_factor)
dta_w_weekday_imputed = cbind(dta_imputed,weekday_factor)
</code></pre>

<h4>Panal plot - compare weekdays and weekends</h4>

<pre><code class="r"># Aggregate on new factor
# (Using m as a temporary variable to simplify the appearance)
m = aggregate(steps ~ time + weekday_factor,
              dta_w_weekday_imputed,
              mean
              )
# Find max steps to put two plots on same scale
max_steps = max(m$steps)

# Plot
par(mfrow = c(2,1))
plot_steps_vs_time(m,&quot;weekday&quot;,max_steps) # See definition of function, ...
plot_steps_vs_time(m,&quot;weekend&quot;,max_steps) # ... in Support Functions section
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAjVBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j485j7U5j9plAABlADllAGVlOQBlZjllZmVltbVltf2POQCPOTmPOWWPZgCPtY+P29qP2/21ZgC1tWW124+1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v0khv9pAAAAL3RSTlP/////////////////////////////////////////////////////////////AFqlOPcAAAAJcEhZcwAACxIAAAsSAdLdfvwAABXLSURBVHic7Z2JmqO4FUZzXalyd1JZ7OlJpqqTHnuS8qS88P6PF8QiVoFAAgT/f77uMsboInOsDQvzh4hA8oelM0CWgeJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheIz7senj9KT588F8zIHFJ9B8Zvl8R6rvcgh1XoRkTe1OltQ4h/v8VL8R35RW1zjF3anJNU1TrUxgMTHit+is7wkGs+iiHXmC0r8JfMe8/x5P6aPSardaenM+wZJ/G1/uB//GfvdnW77uEirwqwXYvH/2R/URkm9kFb16tNw278kpX5jIIm/H19uX358OZ2fPq5JsY5rcr1wP+7+pKr8a1wlZG28KvOq/n/+/fiydN69gyQ+Oj/99vTf4y/Hl6hNvCjNhfjbXtI1l92P/eaaeCzx190/nj/Pf9m/RUkNr9ALaRt/KKp6/ST+BGyviccSH5fqQyxVNdjnrAunF5T4rGefrkjrgnjbeM0GB3dQ4pPh2jXVeE6964VkHK/6+8r8347pR+KguvTJSGBzQIkfySUd8G8Liu9li4M5iu/nIlss8BSPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgu4oWEzITiHdKSqaF4UCgeFETxwWZsTigeFIoHBVJ8sDmbEUDxEmzO5oTiQaF4UCgeFIoHheJBoXhQKB4UPPESbM5mheJBQROf1vNBZm1eJhBvOblnGSg+gyUeFDDxQvEZFA8Kmvg0VxzKo4oPs+c5J1ji8zE8Szyo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" alt="plot of chunk weekdays vs weekends"/> </p>

</body>

</html>
